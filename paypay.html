<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PayPay金運用</title>
    <style>
        body { font-family: -apple-system, sans-serif; background: #fdf2f4; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: white; padding: 30px; border-radius: 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); text-align: center; width: 280px; border-top: 8px solid #ff0033; }
        .label { font-size: 13px; color: #666; }
        .total-value { font-size: 32px; font-weight: bold; color: #333; margin: 10px 0; }
        .profit-box { background: #fff0f0; padding: 15px; border-radius: 12px; margin-bottom: 20px; }
        .profit-value { font-size: 24px; font-weight: bold; color: #ff0033; }
        .btn { background: #ff0033; color: white; border: none; padding: 12px 25px; border-radius: 25px; font-size: 15px; font-weight: bold; cursor: pointer; width: 100%; transition: 0.2s; }
        .btn:active { background: #cc0029; transform: scale(0.98); }
        .info { font-size: 10px; color: #aaa; margin-top: 15px; }
    </style>
</head>
<body>
    <div class="card">
        <div class="label">現在の合計ポイント</div>
        <div id="total" class="total-value">計算中...</div>
        
        <div class="profit-box">
            <div style="font-size: 11px; color:#ff0033; font-weight: bold;">プラス額</div>
            <div id="profit" class="profit-value">--- pt</div>
        </div>

        <button class="btn" onclick="updatePrice()">最新の状態に更新</button>

        <div class="info">
            市場価格(PAXG): $<span id="market-price">--</span><br>
            最終更新: <span id="last-update">--:--:--</span>
        </div>
    </div>

    <script>
        async function updatePrice() {
            const btn = document.querySelector('.btn');
            btn.innerText = "データ取得中...";
            
            try {
                // 金価格連動データの取得
                const response = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=PAXGUSDT');
                const data = await response.json();
                const price = parseFloat(data.price);
                
                // 【あなたの最新データに基づく計算式】
                // 係数: 43113 / 2929.5 ≒ 14.717
                const factor = 8.31311592386; 
                const ganpon = 34878; // 43113 - 8235

                const total = Math.round(price * factor);
                const profit = total - ganpon;

                document.getElementById('total').innerText = total.toLocaleString() + " pt";
                document.getElementById('profit').innerText = (profit >= 0 ? "+" : "") + profit.toLocaleString() + " pt";
                document.getElementById('market-price').innerText = price.toFixed(2);
                document.getElementById('last-update').innerText = new Date().toLocaleTimeString();
            } catch (e) {
                alert("取得に失敗しました。少し待ってから再試行してください。");
            } finally {
                btn.innerText = "最新の状態に更新";
            }
        }

        updatePrice();
    </script>
</body>
</html>